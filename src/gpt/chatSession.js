/**
 * üìå –ö–ª–∞—Å—Å ChatSession ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π –æ–±—â–µ–Ω–∏—è —Å GPT.
 *
 * üîπ –û–ø–∏—Å–∞–Ω–∏–µ:
 * –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π –æ–±—â–µ–Ω–∏—è —Å –º–æ–¥–µ–ª—å—é GPT.
 * –û–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ø—Ä–æ–º—Ç) –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞.
 *
 * üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
 * - `constructor(initialPrompt)` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω–∞—á–∞–ª—å–Ω—ã–º –ø—Ä–æ–º—Ç–æ–º.
 * - `addUserMessage(title, content)` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
 * - `addAssistantMessage(response)` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç GPT.
 * - `getHistory()` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é –æ–±—â–µ–Ω–∏—è.
 *
 * üîπ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
 * ```js
 * import { ChatSession } from './ChatSession.js';
 * 
 * const session = new ChatSession("–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ AI, –ø–æ–º–æ–≥–∞–π –ø–∏—Å–∞—Ç—å –∫—É—Ä—Å.");
 * session.addUserMessage("–í–≤–µ–¥–µ–Ω–∏–µ –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏", "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏?");
 * session.addAssistantMessage("–ù–µ–π—Ä–æ—Å–µ—Ç–∏ ‚Äî —ç—Ç–æ...");
 * console.log(session.getHistory());
 * ```
 */

export class ChatSession {
    /**
     * üîπ –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Å–µ–∞–Ω—Å –æ–±—â–µ–Ω–∏—è —Å GPT.
     * @param {string} initialPrompt - –ù–∞—á–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –º–æ–¥–µ–ª–∏.
     */
    constructor(initialPrompt) {
        this.history = [{ role: 'system', content: initialPrompt }];
        console.log(`‚úÖ –ù–∞—á–∞—Ç –Ω–æ–≤—ã–π —Å–µ–∞–Ω—Å –æ–±—â–µ–Ω–∏—è. –ó–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–æ–º—Ç: "${initialPrompt}"`);
    }
  
    /**
     * üîπ –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏—Å—Ç–æ—Ä–∏—é.
     * @param {string} title - –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞.
     * @param {string} content - –¢–µ–∫—Å—Ç, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
     */
    addUserMessage(title, content) {
        const message = content 
            ? `–†–∞–∑–¥–µ–ª: "${title}". –ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç:\n${content}` 
            : `–°–æ–∑–¥–∞–π —Ä–∞–∑–¥–µ–ª: "${title}".`;
  
        this.history.push({ role: 'user', content: message });
        console.log(`üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${message}`);
    }
  
    /**
     * üîπ –î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (GPT) –≤ –∏—Å—Ç–æ—Ä–∏—é.
     * @param {string} response - –û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏.
     */
    addAssistantMessage(response) {
        this.history.push({ role: 'assistant', content: response });
        console.log(`ü§ñ GPT: ${response.slice(0, 100)}...`); // –í—ã–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ç–≤–µ—Ç–∞
    }
  
    /**
     * üîπ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏—Å—Ç–æ—Ä–∏—é –æ–±—â–µ–Ω–∏—è —Å GPT.
     * @returns {Array} - –ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–∏—Å—Ç–µ–º–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç).
     */
    getHistory() {
        return this.history;
    }
  }
  